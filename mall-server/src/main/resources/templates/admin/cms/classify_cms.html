<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
<head>
    <meta charset="utf-8" />
    <title>云网传媒后台主页</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <meta content="Preview page of Metronic Admin Theme #1 for statistics, charts, recent events and reports" name="description" />
    <meta content="" name="author" />
    <link href="/admin/assets/global/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
    <link href="/admin/assets/global/plugins/simple-line-icons/simple-line-icons.min.css" rel="stylesheet" type="text/css" />
    <link href="/admin/assets/global/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <!-- END PAGE LEVEL PLUGINS -->
    <!-- BEGIN THEME GLOBAL STYLES -->
    <link href="/admin/assets/global/css/components.min.css" rel="stylesheet" id="style_components" type="text/css" />
    <link href="/admin/assets/global/css/plugins.min.css" rel="stylesheet" type="text/css" />
    <!-- END THEME GLOBAL STYLES -->
    <!-- BEGIN THEME LAYOUT STYLES -->
    <link href="/admin/assets/layouts/layout/css/layout.min.css" rel="stylesheet" type="text/css" />
    <link href="/admin/assets/layouts/layout/css/themes/darkblue.min.css" rel="stylesheet" type="text/css" id="style_color" />
    <!-- END THEME LAYOUT STYLES -->
    <link rel="shortcut icon" href="favicon.ico" /> 
    <link rel="stylesheet" href="/admin/assets/layouts/layout/css/style.css">
    </head>
<!-- END HEAD -->

<body class="page-header-fixed page-sidebar-closed-hide-logo page-content-white">
        
   
            
             <!-- 内容部分 -->
            <div class="page-content-wrapper">
                <!-- BEGIN CONTENT BODY -->
                <div class="page-content">
                    <!-- BEGIN PAGE HEADER-->
                    <!-- BEGIN PAGE BAR -->
                    <div class="page-bar">
                        <ul class="page-breadcrumb">
                            <li>
                                <a href="index.html">首页</a>
                                <i class="fa fa-circle"></i>
                            </li>
                            <li>
                                <span>分类管理</span>
                            </li>
                        </ul>
                    </div>
                    <!-- 内容展示 -->
                    <div class="row">
    <div class="col-md-12">
        <div class="portlet light bordered">
            <div class="portlet-body">
                <div class="table-toolbar">
                    <div class="row">
                    	<span id='msg' style="color:red"></span>
                        <div class="form-group">
                            <ul class="classify_list">
                                <li class="f_list"><span>名家荟萃</span> <i class="btn add_child">新增子分类</i>
                                	<span style="display:none" >MJHC</span>
                                    <ul class="c_list">
                                        <li th:each="ca:${mjhc}"> <span class="left_textbody" contenteditable="true" th:text="${ca.ladelname}">名人展示</span>
                                        	<span style="display:none" th:text="${ca.id}">04</span>
                                            <span class="btn green c_btn amend_btn">修改</span>&nbsp;
                                            <span class="btn red c_btn delete_btn">删除</span>
                                        </li>
                                    </ul>
                                </li>
                                <li class="f_list"><span>作品锦集</span><i class="btn add_child">新增子分类</i>
                                	<span style="display:none" >ZPJJ</span>
                                    <ul class="c_list">
                                        <li th:each="ca:${zpjj}"> <span class="left_textbody" contenteditable="true" th:text="${ca.ladelname}">名人展示</span>
                                        	<span style="display:none" th:text="${ca.id}">04</span>
                                            <span class="btn green c_btn amend_btn">修改</span>&nbsp;
                                            <span class="btn red c_btn delete_btn">删除</span>
                                        </li>
                                        
                                    </ul>
                                </li>
                                <li class="f_list"><span>资讯中心</span><i class="btn add_child">新增子分类</i>
                                	<span style="display:none" >ZXZX</span>
                                    <ul class="c_list">
                                        <li th:each="ca:${zxzx}"> <span class="left_textbody" contenteditable="true" th:text="${ca.ladelname}">名人展示</span>
                                        	<span style="display:none" th:text="${ca.id}">04</span>
                                            <span class="btn green c_btn amend_btn">修改</span>&nbsp;
                                            <span class="btn red c_btn delete_btn">删除</span>
                                        </li>
                                        
                                    </ul>
                                </li>
                                <li class="f_list"><span>传统文化</span><i class="btn add_child">新增子分类</i>
                                <span style="display:none" >CTWH</span>
                                    <ul class="c_list">
                                        <li th:each="ca:${ctwh}"> <span class="left_textbody" contenteditable="true" th:text="${ca.ladelname}">名人展示</span>
                                        	<span style="display:none" th:text="${ca.id}">04</span>
                                            <span class="btn green c_btn amend_btn">修改</span>&nbsp;
                                            <span class="btn red c_btn delete_btn">删除</span>
                                        </li>
                                        
                                    </ul>
                                </li>
                            </ul>

                    </div>
                </div>

            </div>
        </div>
    </div>

</div>

                    <div class="clearfix"></div>
                    
                </div>
                <!-- END CONTENT BODY -->
            </div>
        </div>
        
        <!-- END FOOTER -->
    
    <div class="quick-nav-overlay"></div>
    <script src="/admin/assets/global/plugins/jquery.min.js" type="text/javascript"></script>
        <script src="/admin/assets/global/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
        <script src="../assets/global/plugins/bootbox/bootbox.min.js" type="text/javascript"></script>
        <script>
            $(function(){
                $(".add_child").click(function(){
                    //新增
                   $(this).parent('.f_list').find('.c_list').append('<li ><span class="left_textbody" contenteditable="true">新增子分类</span><span class="btn c_btn queding_add">新增</span>&nbsp;<span class="btn red c_btn">取消</span></li>');
                   $(this).parent('.f_list').find('.c_list').children("li:last-child").find('.left_textbody').focus();

                   $(".queding_add").click(function(){
                	   $.post("/category/add",
                			   {ladelname:$(this).prev().text(),
                		   		parentId:$(this).parent().parent().prev().text(),
                		   		hierarchy:'2'},
                		   		function(date){
                		   			if(date.res=='1'){
                		   				//成功
                		   				bootbox.alert("新增成功,一秒刷新");
                		   				setTimeout(function(){
                    		   				window.location.reload();
                    		   				},1000)
                		   			}else{
                		   				$("#msg").text(adte.msg);
                		   			}
                		   		},'json'
                			   )
                      
                    })
                })

                $(".delete_btn").click(function(){
                	console.log($(this).prev().prev().text());
                	bootbox.confirm("删除将不可恢复，你娶定要删除?", function(result) {
                		if(result){
                            $.post("/category/delete",
                     			   {id:$(this).prev().prev().text()
                     		   		},
                     		   		function(date){
                     		   		//成功
                		   				bootbox.alert("删除成功,1秒跳转");
                      		   		   setTimeout(function(){
                		   			    	window.location.reload();
                		   				},1000)
                     		   			
                     		   		},'json'
                     			   )	
                		}else{
                			bootbox.hideAll();
							return false;
                        }
                	})
             			   
                })
                $(".amend_btn").click(function(){
                    $.post("/category/update",
             			   {id:$(this).prev().text(),
                    		ladelname:$(this).prev().prev().text()
                    		
             		   		},
             		   		function(date){
             		   			bootbox.alert("修改成功");
	             		   		setTimeout(function(){
	         		   				bootbox.hideAll();
	    		   				},800)
             		   			$("#msg").text(date.msg);
             		   		},'json'
             			   )
             			   
                })
                
            })
        </script>
</body>

</html>
